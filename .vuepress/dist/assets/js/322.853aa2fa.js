(window.webpackJsonp=window.webpackJsonp||[]).push([[322],{488:function(e,t,a){"use strict";a.r(t);var n=a(0),s=Object(n.a)({},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[e._m(0),e._v(" "),e._m(1),e._v(" "),e._m(2),e._v(" "),e._m(3),e._v(" "),a("p",[e._v("This class is analogous to the "),a("code",[e._v("AsyncResource")]),e._v(" JavaScript class exposed by Node's "),a("a",{attrs:{href:"https://nodejs.org/dist/latest-v9.x/docs/api/async_hooks.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("async_hooks"),a("OutboundLink")],1),e._v(" API.")]),e._v(" "),a("p",[e._v("When calling back into JavaScript asynchronously, special care must be taken to ensure that the runtime can properly track\nasync hops. "),a("code",[e._v("Nan::AsyncResource")]),e._v(" is a class that provides an RAII wrapper around "),a("code",[e._v("node::EmitAsyncInit")]),e._v(", "),a("code",[e._v("node::EmitAsyncDestroy")]),e._v(",\nand "),a("code",[e._v("node::MakeCallback")]),e._v(". Using this mechanism to call back into JavaScript, as opposed to "),a("code",[e._v("Nan::MakeCallback")]),e._v(" or\n"),a("code",[e._v("v8::Function::Call")]),e._v(" ensures that the callback is executed in the correct async context. This ensures that async mechanisms\nsuch as domains and "),a("a",{attrs:{href:"https://nodejs.org/dist/latest-v9.x/docs/api/async_hooks.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("async_hooks"),a("OutboundLink")],1),e._v(" function correctly.")]),e._v(" "),a("p",[e._v("Definition:")]),e._v(" "),e._m(4),a("ul",[a("li",[a("code",[e._v("name")]),e._v(": Identifier for the kind of resource that is being provided for diagnostics information exposed by the "),a("a",{attrs:{href:"https://nodejs.org/dist/latest-v9.x/docs/api/async_hooks.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("async_hooks"),a("OutboundLink")],1),e._v("\nAPI. This will be passed to the possible "),a("code",[e._v("init")]),e._v(" hook as the "),a("code",[e._v("type")]),e._v(". To avoid name collisions with other modules we recommend\nthat the name include the name of the owning module as a prefix. For example "),a("code",[e._v("mysql")]),e._v(" module could use something like\n"),a("code",[e._v("mysql:batch-db-query-resource")]),e._v(".")]),e._v(" "),a("li",[a("code",[e._v("resource")]),e._v(": An optional object associated with the async work that will be passed to the possible "),a("a",{attrs:{href:"https://nodejs.org/dist/latest-v9.x/docs/api/async_hooks.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("async_hooks"),a("OutboundLink")],1),e._v(" "),a("code",[e._v("init")]),e._v(" hook. If this parameter is omitted, or an empty handle is provided, this object will be created automatically.")]),e._v(" "),e._m(5),e._v(" "),e._m(6)]),e._v(" "),a("p",[e._v("For more details, see the Node "),a("a",{attrs:{href:"https://nodejs.org/dist/latest-v9.x/docs/api/async_hooks.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("async_hooks"),a("OutboundLink")],1),e._v(" documentation. You might also want to take a look at the documentation for the\n"),a("a",{attrs:{href:"https://nodejs.org/dist/latest-v9.x/docs/api/n-api.html#n_api_custom_asynchronous_operations",target:"_blank",rel:"noopener noreferrer"}},[e._v("N-API counterpart"),a("OutboundLink")],1),e._v(". For example usage, see the "),a("code",[e._v("asyncresource.cpp")]),e._v(" example in the "),a("code",[e._v("test/cpp")]),e._v(" directory.")]),e._v(" "),e._m(7),e._v(" "),e._m(8),e._v(" "),e._m(9),e._v(" "),e._m(10),e._v(" "),a("p",[e._v("Signatures:")]),e._v(" "),e._m(11),e._m(12),e._v(" "),e._m(13),e._v(" "),e._m(14),e._v(" "),a("p",[e._v("See example below.")]),e._v(" "),e._m(15),e._v(" "),e._m(16),e._v(" "),a("p",[e._v("A simple helper to register a "),a("code",[e._v("v8::FunctionTemplate")]),e._v(" from a JavaScript-accessible method (see "),a("router-link",{attrs:{to:"./methods.html"}},[e._v("Methods")]),e._v(") as a property on an object. Can be used in a way similar to assigning properties to "),a("code",[e._v("module.exports")]),e._v(" in JavaScript.")],1),e._v(" "),a("p",[e._v("Signature:")]),e._v(" "),e._m(17),e._m(18),e._v(" "),a("p",[e._v("Example:")]),e._v(" "),e._m(19)])},[function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"miscellaneous-node-helpers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#miscellaneous-node-helpers","aria-hidden":"true"}},[this._v("#")]),this._v(" Miscellaneous Node Helpers")])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[t("a",{attrs:{href:"#api_nan_asyncresource"}},[t("b",[t("code",[this._v("Nan::AsyncResource")])])])]),this._v(" "),t("li",[t("a",{attrs:{href:"#api_nan_make_callback"}},[t("b",[t("code",[this._v("Nan::MakeCallback()")])])])]),this._v(" "),t("li",[t("a",{attrs:{href:"#api_nan_module_init"}},[t("b",[t("code",[this._v("NAN_MODULE_INIT()")])])])]),this._v(" "),t("li",[t("a",{attrs:{href:"#api_nan_export"}},[t("b",[t("code",[this._v("Nan::Export()")])])])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("a",{attrs:{name:"api_nan_asyncresource"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"nan-asyncresource"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nan-asyncresource","aria-hidden":"true"}},[this._v("#")]),this._v(" Nan::AsyncResource")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-c++ extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("class AsyncResource {\n public:\n  AsyncResource(v8::Local<v8::String> name,\n                v8::Local<v8::Object> resource = New<v8::Object>());\n  AsyncResource(const char* name,\n                v8::Local<v8::Object> resource = New<v8::Object>());\n  ~AsyncResource();\n\n  v8::MaybeLocal<v8::Value> runInAsyncScope(v8::Local<v8::Object> target,\n                                            v8::Local<v8::Function> func,\n                                            int argc,\n                                            v8::Local<v8::Value>* argv);\n  v8::MaybeLocal<v8::Value> runInAsyncScope(v8::Local<v8::Object> target,\n                                            v8::Local<v8::String> symbol,\n                                            int argc,\n                                            v8::Local<v8::Value>* argv);\n  v8::MaybeLocal<v8::Value> runInAsyncScope(v8::Local<v8::Object> target,\n                                            const char* method,\n                                            int argc,\n                                            v8::Local<v8::Value>* argv);\n};\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[this._v("When calling JS on behalf of this resource, one can use "),t("code",[this._v("runInAsyncScope")]),this._v(". This will ensure that the callback runs in the\ncorrect async execution context.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("code",[this._v("AsyncDestroy")]),this._v(" is automatically called when an AsyncResource object is destroyed.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("a",{attrs:{name:"api_nan_make_callback"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"nan-makecallback"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nan-makecallback","aria-hidden":"true"}},[this._v("#")]),this._v(" Nan::MakeCallback()")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Deprecated wrappers around the legacy "),t("code",[this._v("node::MakeCallback()")]),this._v(" APIs. Node.js 10+\nhas deprecated these legacy APIs as they do not provide a mechanism to preserve\nasync context.")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",[e._v("We recommend that you use the "),a("code",[e._v("AsyncResource")]),e._v(" class and "),a("code",[e._v("AsyncResource::runInAsyncScope")]),e._v(" instead of using "),a("code",[e._v("Nan::MakeCallback")]),e._v(" or\n"),a("code",[e._v("v8::Function#Call()")]),e._v(" directly. "),a("code",[e._v("AsyncResource")]),e._v(" properly takes care of running the callback in the correct async execution\ncontext â€“ something that is essential for functionality like domains, async_hooks and async debugging.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-c++ extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("NAN_DEPRECATED\nv8::Local<v8::Value> Nan::MakeCallback(v8::Local<v8::Object> target,\n                                       v8::Local<v8::Function> func,\n                                       int argc,\n                                       v8::Local<v8::Value>* argv);\nNAN_DEPRECATED\nv8::Local<v8::Value> Nan::MakeCallback(v8::Local<v8::Object> target,\n                                       v8::Local<v8::String> symbol,\n                                       int argc,\n                                       v8::Local<v8::Value>* argv);\nNAN_DEPRECATED\nv8::Local<v8::Value> Nan::MakeCallback(v8::Local<v8::Object> target,\n                                       const char* method,\n                                       int argc,\n                                       v8::Local<v8::Value>* argv);\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("a",{attrs:{name:"api_nan_module_init"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"nan-module-init"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nan-module-init","aria-hidden":"true"}},[this._v("#")]),this._v(" NAN_MODULE_INIT()")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Used to define the entry point function to a Node add-on. Creates a function with a given "),t("code",[this._v("name")]),this._v(" that receives a "),t("code",[this._v("target")]),this._v(" object representing the equivalent of the JavaScript "),t("code",[this._v("exports")]),this._v(" object.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("a",{attrs:{name:"api_nan_export"}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("h3",{attrs:{id:"nan-export"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#nan-export","aria-hidden":"true"}},[this._v("#")]),this._v(" Nan::Export()")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-c++ extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("void Export(v8::Local<v8::Object> target, const char *name, Nan::FunctionCallback f)\n")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Also available as the shortcut "),t("code",[this._v("NAN_EXPORT")]),this._v(" macro.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language-c++ extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("NAN_METHOD(Foo) {\n  ...\n}\n\nNAN_MODULE_INIT(Init) {\n  NAN_EXPORT(target, Foo);\n}\n")])])])}],!1,null,null,null);t.default=s.exports}}]);